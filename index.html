<!-- Index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>KBK Membership Form</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style> body { background-color: lightgreen; font-family: Arial, sans-serif; } h1 { text-align: center; font-weight: bold; } .section-title { font-size: 18px; font-weight: bold; margin: 20px auto 10px auto; max-width: 1000px; text-align: left; display: flex; align-items: center; } .section-title i { display: inline-block; margin-left: -18px; margin-right: 8px; } form { Position: relative; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 0 auto; max-width: 1000px; background: #ECFFDC; padding: 20px; border-radius: 10px; } .form-group { display: flex; flex-direction: column; margin-bottom: 15px; width: 200px; height: 30px; } .form-s { display: flex; flex-direction: column; width: 150px; height: 30px; } .form-fn { display: flex; flex-direction: column; margin-top: 120px; margin-bottom: 30px; width: 350px; height: 30px; } .form-ln { display: flex; flex-direction: column; margin-bottom: 30px; width: 350px; height: 30px; } .form-bd { display: flex; flex-direction: column; margin-bottom: 30px; width: 150px; height: 30px; } .form-phn { display: flex; flex-direction: column; margin-bottom: 30px; width: 250px; height: 30px; } .form-g { display: flex; flex-direction: column; width: 150px; height: 30px; } .form-em { display: flex; flex-direction: column; width: 350px; height: 30px; } .form-hbl { display: flex; flex-direction: column; margin-bottom: 30px; width: 300px; height: 30px; } .form-add1 { display: flex; flex-direction: column; width: 350px; height: 30px; } .form-add2 { display: flex; flex-direction: column; margin-bottom: 30px; width: 350px; height: 30px; } .form-c { display: flex; flex-direction: column; margin-bottom: 30px; width: 250px; height: 30px; } .form-r { display: flex; flex-direction: column; margin-bottom: 30px; width: 350px; height: 30px; } .form-m { display: flex; flex-direction: column; margin-top: 120px; width: 350px; height: 30px; } .form-pn { display: flex; flex-direction: column; width: 200px; height: 30px; } .form-b { display: flex; flex-direction: column; width: 200px; height: 30px; } .form-post { display: flex; flex-direction: column; width: 200px; height: 30px; } label { font-style: italic; font-weight: bold; margin-bottom: 5px; } input, select { padding: 8px; border: 1px solid #ccc; border-radius: 6px; } .address-subtitle { grid-column: span 2; font-weight: bold; margin-top: 15px; } .btn { background-color: orange; color: white; padding: 10px 30px; border: none; font-weight: bold; border-radius: 8px; cursor: pointer; font-size: 16px; } .btn-container { grid-column: span 2; text-align: left; margin-top: 20px; } #preview { position: absolute; top: 10px; right: 10px; width: 140px; height: 140px; border-radius: 10px; border: 2px solid #333; object-fit: cover; display: none; z-index: 10; background: #fff; } </style>
</head>
<body>
  <h1>KBK Membership Form</h1>
  <div class="section-title"><i>ðŸ‘¤</i> Personal Information</div>

  <form id="kbkForm">
    <div class="form-fn">
      <label>First Name *</label>
      <input type="text" id="firstName" name="firstName" required>
    </div>

    <div class="form-m">
      <label>Middle Name *</label>
      <input type="text" id="middleName" name="middleName" required placeholder="Put N/A if no middle name" title="Put N/A if no Middle Name">
    </div>

    <div class="form-ln">
      <label>Last Name *</label>
      <input type="text" id="lastName" name="lastName" required>
    </div>

    <div class="form-s">
      <label>Suffix <small>(Sr., Jr, III,)</small></label>
      <select id="Suffix" name="Suffix">
        <option value="">Select...</option>
        <option>Sr.</option>
        <option>Jr.</option>
        <option>III</option>
        <option>IV</option>
        <option>V</option>
      </select>
    </div>

    <div class="form-bd">
      <label>Date of Birth *</label>
      <input type="text" id="dob" name="dob" placeholder="MM/DD/YYYY" pattern="(0[1-9]|1[0-2])/(0[1-9]|[12][0-9]|3[01])/(19[0-9]{2}|200[0-9])" title="Please make sure youre 16 years old and above (MM/DD/YYYY)">
    </div>

    <div class="form-g">
      <label>Gender *</label>
      <select id="gender" name="gender" required>
        <option value="">Select...</option>
        <option>Male</option>
        <option>Female</option>
      </select>
    </div>

    <div class="form-phn">
      <label>Phone Number *</label>
      <input type="text" id="phone" name="phone" required pattern="^0\d{10}$" title="Please check phone number make sure it's 11 Digit an start with 0">
    </div>

    <div class="form-em">
      <label>Email Address *</label>
      <input type="email" id="email" name="email" required pattern="^[^@\s]+@[^@\s]+\.[^@\s]+$">
    </div>

    <div class="address-subtitle">Complete Address</div>

    <div class="form-hbl">
      <label>House No. / Blk, Lot</label>
      <input type="text" id="houseNo" name="houseNo" pattern="^(\d{1,5}[A-Za-z]?|blk.*|lot.*)?$" title="Please put your house number only or blk and lot if no house number leave it blank">
    </div>

    <div class="form-add1">
      <label>Address Line 1 <small>(Street Name / Phase / Area)</small> *</label>
      <input type="text" id="addr1" name="addr1" required pattern="^(?!.*([Cc][Aa][Ll][Oo][Oo][Cc][Aa][Nn]\s+[Cc][Ii][Tt][Yy])).*$" title="Do not include Caloocan City on this Field it's already pre filled out on the City Field">
    </div>

    <div class="form-add2">
      <label>Address Line 2 <small>(Optional)</small></label>
      <input type="text" id="addr2" name="addr2" pattern="^(?!.*([Cc][Aa][Ll][Oo][Oo][Cc][Aa][Nn]\s+[Cc][Ii][Tt][Yy])).*$" title="Do not include Caloocan City on this Field it's already pre filled out on the City Field">
    </div>

    <div class="form-b">
      <label>Barangay <small>(Number Only)</small>*</label>
      <input type="text" id="barangay" name="barangay" required pattern="^(1[0-7][0-9]|[1-9][0-9]?|17[7-9]|18[0-8]|176-[A-F])$" title="Please put a valid Caloocan Brgy. No. for Bagong Silang please put Brgy Number followed by dash and the Letter Ex.: 176-A">
    </div>

    <div class="form-c">
      <label>City</label>
      <input type="text" id="city" name="city" value="Caloocan City" readonly>
    </div>

    <div class="form-post">
      <label>Position *</label>
      <select id="position" name="position" required>
        <option value="">Select...</option>
        <option>Team Leader</option>
        <option>Member</option>
      </select>
    </div>

    <div class="form-r">
      <label>Referrer *</label>
      <input type="text" id="referrer" name="referrer" required>
    </div>

    <div class="form-pn">
      <label>Precint Number *</label>
      <input type="text" id="precinct" name="precinct" required title="Put N/A it forgotten of not yet registered voter">
    </div>

    <div class="form-group">
      <label>Picture / Selfie *</label>
      <input type="file" id="picture" name="picture" accept="image/*" capture="environment" required>
    </div>

    <div class="btn-container">
      <button type="submit" class="btn">Submit</button>
    </div>

    <div class="message" id="message"></div>
    <img id="preview" alt="Preview">
  </form>

  <script>
    const form = document.getElementById("kbkForm");
    const preview = document.getElementById("preview");
    const messageEl = document.getElementById("message");
    const pictureInput = document.getElementById("picture");

    pictureInput.addEventListener("change", function(e) {
      const file = e.target.files[0];
      if (!file) { preview.style.display = "none"; return; }
      const reader = new FileReader();
      reader.onload = function(evt) {
        preview.src = evt.target.result;
        preview.style.display = "block";
      };
      reader.readAsDataURL(file);
    });

    form.addEventListener("submit", function(e) {
  e.preventDefault();
  messageEl.textContent = "Submitting Please Wait...";
  const file = pictureInput.files[0];
  if (!file) { messageEl.textContent = "Please attach a picture."; return; }
  const reader = new FileReader();
  reader.onload = function(evt) {
    const dataUrl = evt.target.result;
    const payload = {
      firstName: document.getElementById("firstName").value,
      middleName: document.getElementById("middleName").value,
      lastName: document.getElementById("lastName").value,
      Suffix: document.getElementById("Suffix").value,
      dob: document.getElementById("dob").value,
      gender: document.getElementById("gender").value,
      phone: document.getElementById("phone").value,
      email: document.getElementById("email").value,
      houseNo: document.getElementById("houseNo").value,
      addr1: document.getElementById("addr1").value,
      addr2: document.getElementById("addr2").value,
      city: document.getElementById("city").value,
      barangay: document.getElementById("barangay").value,
      position: document.getElementById("position").value,
      referrer: document.getElementById("referrer").value,
      precinct: document.getElementById("precinct").value,
      pictureDataUrl: dataUrl
    };

    fetch("https://script.google.com/macros/s/AKfycbyxKxkFQBCgImtmjRAZAxEEEdyAzwgDHlDRvnq5f2-mKC0mZ3n9EXVvwig-UgNEVWsDGw/exec", {
      method: "POST",
  body: JSON.stringify(payload),
  headers: { "Content-Type": "application/json" }
})
.then(r => r.json())
.then(res => {
  if (res && res.success) {
    document.body.innerHTML = `
      <h1 style="text-align:center; margin-top:100px;">
        Your Details has been recorded to Kasangga ng Batang Kankaloo Database.<br>
        Please give us 10 - 15 minutes while we are validation your details.<br>
        Check your email after 20 mins for the soft copy of your <Strong>KBK ID and Membership Form</Strong>
      </h1>
    `;
  } else {
    messageEl.textContent = res.message || "Submission failed. Please try again.";
  }
})
.catch(err => {
  messageEl.textContent = "Submission error: " + err.message;
});
  </script>
</body>
</html>


