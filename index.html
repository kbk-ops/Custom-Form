<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>KBK Membership Form</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      background-color: lightgreen;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0 10px;
      box-sizing: border-box;
    }
    h1 {
      text-align: center;
      font-weight: bold;
      margin-top: 20px;
    }
    .section-title {
      font-size: 18px;
      font-weight: bold;
      margin: 20px auto 10px auto;
      max-width: 1000px;
      text-align: left;
      display: flex;
      align-items: center;
    }
    .section-title i {
      display: inline-block;
      margin-left: -18px;
      margin-right: 8px;
    }
    form {
      position: relative;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 15px;
      margin: 0 auto 40px auto;
      max-width: 1000px;
      background: #ecffdc;
      padding: 20px;
      border-radius: 10px;
      box-sizing: border-box;
    }
    .form-group,
    .form-fn, .form-m, .form-ln, .form-s, .form-bd,
    .form-g, .form-phn, .form-em, .form-hbl, .form-add1,
    .form-add2, .form-c, .form-r, .form-m, .form-pn,
    .form-b, .form-post {
      display: flex;
      flex-direction: column;
      width: 100%;
      max-width: 100%;
    }
    label {
      font-style: italic;
      font-weight: bold;
      margin-bottom: 5px;
    }
    input, select, button {
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 1rem;
      box-sizing: border-box;
    }
    .address-subtitle {
      grid-column: 1 / -1;
      font-weight: bold;
      margin-top: 10px;
      font-size: 1.1rem;
    }
    .btn {
      background-color: orange;
      color: white;
      padding: 12px 50px;
      border: none;
      font-weight: bold;
      border-radius: 20px;
      cursor: pointer;
      font-size: 1.25rem;
      transition: all 0.3s ease;
      width: fit-content;
      justify-self: center;
      grid-column: 1 / -1;
      margin-top: 40px;
    }
    @keyframes shake {
      0% { transform: translateX(0); }
      30% { transform: translateX(-10px); }
      60% { transform: translateX(10px); }
      90% { transform: translateX(-10px); }
      120% { transform: translateX(10px); }
      150% { transform: translateX(0); }
    }
    .btn:active {
      animation: shake 0.5s;
    }
    .btn:hover {
      background-color: darkorange;
      transform: scale(1.1);
    }
    #logo {
      position: fixed;
      top: 10px;
      left: 20px;
      width: 120px;
      height: 120px;
      border-radius: 10px;
      z-index: 10;
      object-fit: contain;
      background: white;
    }
    #mayor {
      position: fixed;
      bottom: 10px;
      right: 10px;
      width: 120px;
      height: 120px;
      border-radius: 10px;
      z-index: 10;
      object-fit: contain;
      background: white;
    }
    #preview {
      position: fixed;
      top: 150px;
      right: 20px;
      width: 130px;
      height: 130px;
      border-radius: 10px;
      border: 2px solid #333;
      object-fit: cover;
      display: none;
      z-index: 10;
      background: #fff;
    }
    .modal {
      display: none;
      position: fixed;
      z-index: 999;
      padding-top: 100px;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0, 0, 0, 0.6);
    }
    .modal-content {
      background-color: #fff;
      margin: auto;
      padding: 20px;
      border-radius: 8px;
      width: 90%;
      max-width: 600px;
      text-align: center;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }
    .modal-content img {
      max-width: 100%;
      height: auto;
      margin-bottom: 15px;
      border-radius: 5px;
    }
    .close-btn {
      color: #aaa;
      float: right;
      font-size: 24px;
      font-weight: bold;
      cursor: pointer;
    }
    .close-btn:hover {
      color: black;
    }
    button {
      margin-top: 5px;
      padding: 10px 20px;
      cursor: pointer;
    }

    /* Responsive adjustments */
    @media (max-width: 600px) {
      form {
        grid-template-columns: 1fr;
      }
      #logo, #mayor {
        position: static;
        width: 80px;
        height: 80px;
        margin: 10px auto;
        display: block;
      }
      #preview {
        position: static;
        width: 100px;
        height: 100px;
        margin: 10px auto;
        display: block;
      }
      .btn {
        width: 100%;
        padding: 15px;
        font-size: 1.1rem;
      }
    }
  </style>
</head>
<body>
  <h1>KBK Membership Form</h1>
  <div class="section-title"><i>游녻</i> Personal Information</div>

  <form id="kbkForm" novalidate>
    <div class="form-fn">
      <label for="firstName">First Name *</label>
      <input
        type="text"
        id="firstName"
        name="firstName"
        required
        pattern="^([A-Za-z-칐칒-칬칮-칌침\.]+)(\s+[A-Za-z-칐칒-칬칮-칌침\.]+){0,2}$"
        placeholder="First Name"
      />
    </div>

    <div class="form-m">
      <label for="middleName">Middle Name *</label>
      <input
        type="text"
        id="middleName"
        name="middleName"
        required
        placeholder="Middle Name, Put N/A if no middle name"
        pattern="^(?!.*[.])(?=.*[A-Za-z0-9]).{2,}$"
        title="Input your Middle Name, not middle initial. Put N/A if there is no Middle Name."
      />
    </div>

    <div class="form-ln">
      <label for="lastName">Last Name *</label>
      <input
        type="text"
        id="lastName"
        name="lastName"
        required
        placeholder="Last Name"
        pattern="^([A-Za-z-칐칒-칬칮-칌침]+)(\s+[A-Za-z-칐칒-칬칮-칌침]+){0,2}$"
      />
    </div>

    <div class="form-s">
      <label for="Suffix">Suffix <small>(Sr., Jr, III,)</small></label>
      <select id="Suffix" name="Suffix">
        <option value="">Select Suffix...</option>
        <option>Sr.</option>
        <option>Jr.</option>
        <option>III</option>
      </select>
    </div>

    <div class="form-bd">
      <label for="dob">Date of Birth *</label>
      <input
        type="text"
        id="dob"
        name="dob"
        placeholder="MM/DD/YYYY"
        pattern="(0[1-9]|1[0-2])\/(0[1-9]|[12][0-9]|3[01])\/(19[0-9]{2}|200[0-9])"
        required
        title="Please make sure you're 16 years old and above (MM/DD/YYYY)"
      />
    </div>

    <div class="form-g">
      <label for="gender">Gender *</label>
      <select id="gender" name="gender" required>
        <option value="">Select Gender...</option>
        <option>Male</option>
        <option>Female</option>
      </select>
    </div>

    <div class="form-phn">
      <label for="phone">Phone Number *</label>
      <input
        type="text"
        id="phone"
        name="phone"
        required
        pattern="^0\d{10}$"
        placeholder="09XXXXXXXXX"
        title="Please check phone number. Make sure it's 11 digits and starts with 0."
      />
    </div>

    <div class="form-em">
      <label for="email">Email Address *</label>
      <input
        type="email"
        id="email"
        name="email"
        required
        placeholder="E-mail Address"
        pattern="^[^@\s]+@[^@\s]+\.[^@\s]+$"
      />
    </div>

    <div class="address-subtitle">Complete Address</div>

    <div class="form-hbl">
      <label for="houseNo">House No. / Blk, Lot</label>
      <input
        type="text"
        id="houseNo"
        name="houseNo"
        pattern="^(\d{1,5}[A-Za-z]?|blk.*|lot.*)?$"
        placeholder="House No., Blk & Lot only"
        title="Please put your house number only or blk and lot if no house number leave it blank"
      />
    </div>

    <div class="form-add1">
      <label for="addr1"
        >Address Line 1 <small>(Street Name / Phase / Area)</small> *</label
      >
      <input
        type="text"
        id="addr1"
        name="addr1"
        required
        pattern="^(?!.*([Cc][Aa][Ll][Oo][Oo][Cc][Aa][Nn]\s+[Cc][Ii][Tt][Yy]))(?!.*[0-9]).+$"
        placeholder="Street name, Phase or Area only"
        title="Do not include any numbers or Caloocan City on this field; it's already pre-filled out on the City field"
      />
    </div>

    <div class="form-add2">
      <label for="addr2">Address Line 2 <small>(Optional)</small></label>
      <input
        type="text"
        id="addr2"
        name="addr2"
        pattern="^(?!.*([Cc][Aa][Ll][Oo][Oo][Cc][Aa][Nn]\s+[Cc][Ii][Tt][Yy]))(?!.*[0-9]).+$"
        placeholder="Optional"
        title="Do not include any numbers or Caloocan City on this field; it's already pre-filled out on the City field"
      />
    </div>

    <div class="form-b">
      <label for="barangay">Barangay <small>(Number Only)</small>*</label>
      <input
        type="text"
        id="barangay"
        name="barangay"
        required
        pattern="^(1[0-7][0-9]|[1-9][0-9]?|17[7-9]|18[0-8]|176-[A-F])$"
        placeholder="Brgy. Number only"
        title="Please put a valid Caloocan Brgy. No. For Bagong Silang please put Brgy Number followed by dash and the Letter Ex.: 176-A"
      />
    </div>

    <div class="form-c">
      <label for="city">City</label>
      <input type="text" id="city" name="city" value="Caloocan City" readonly />
    </div>

    <div class="form-post">
      <label for="position">Position *</label>
      <select id="position" name="position" required>
        <option value="">Select Position...</option>
        <option>Team Leader</option>
        <option>Family Member</option>
      </select>
    </div>

    <div class="form-r">
      <label for="referrer">Referrer *</label>
      <input
        type="text"
        id="referrer"
        name="referrer"
        placeholder="First Name and Last Name of Referrer only"
        required
      />
    </div>

    <div class="form-pn">
      <label for="precinctNo">Precinct No. *</label>
      <input
        type="text"
        id="precinctNo"
        name="precinctNo"
        pattern="^\d{3,6}$"
        placeholder="Precinct Number"
        required
      />
    </div>

    <button class="btn" type="submit">Submit</button>
  </form>

  <img
    src="https://media.discordapp.net/attachments/1080153629797790760/1135707282489412682/ksb_logo_400.png"
    alt="KBK Logo"
    id="logo"
  />
  <img
    src="https://media.discordapp.net/attachments/1080153629797790760/1135909022982500382/mayor.png"
    alt="Mayor Image"
    id="mayor"
  />
  <img id="preview" alt="Image Preview" />

  <div id="modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-describedby="modalDesc">
    <div class="modal-content">
      <span class="close-btn" id="closeModal" aria-label="Close">&times;</span>
      <h2 id="modalTitle">Form Submission Summary</h2>
      <div id="modalDesc"></div>
      <button id="closeModalBtn">Close</button>
    </div>
  </div>

  <script>
    const form = document.getElementById('kbkForm');
    const modal = document.getElementById('modal');
    const modalDesc = document.getElementById('modalDesc');
    const closeModal = document.getElementById('closeModal');
    const closeModalBtn = document.getElementById('closeModalBtn');

    form.addEventListener('submit', function (e) {
      e.preventDefault();

      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      // Validate age is 16+
      const dobInput = form.dob.value.trim();
      const dob = new Date(dobInput);
      const today = new Date();
      const ageDiff = today.getFullYear() - dob.getFullYear();
      const monthDiff = today.getMonth() - dob.getMonth();
      const dayDiff = today.getDate() - dob.getDate();
      let age = ageDiff;
      if (monthDiff < 0 || (monthDiff === 0 && dayDiff < 0)) {
        age--;
      }
      if (age < 16) {
        alert('You must be at least 16 years old to register.');
        return;
      }

      // Build summary content
      let summaryHTML = '<ul style="text-align:left;">';
      for (const element of form.elements) {
        if (element.name && element.type !== 'submit' && element.type !== 'button') {
          const label = form.querySelector(`label[for="${element.id}"]`);
          const labelText = label ? label.innerText.replace(/\*|\(.*?\)/g, '').trim() : element.name;
          let value = element.value.trim();
          if (element.tagName === 'SELECT' && !value) value = 'Not selected';
          summaryHTML += `<li><strong>${labelText}:</strong> ${value}</li>`;
        }
      }
      summaryHTML += '</ul>';

      modalDesc.innerHTML = summaryHTML;
      modal.style.display = 'block';
      modal.focus();
    });

    closeModal.addEventListener('click', () => {
      modal.style.display = 'none';
    });
    closeModalBtn.addEventListener('click', () => {
      modal.style.display = 'none';
    });

    window.addEventListener('click', (event) => {
      if (event.target === modal) {
        modal.style.display = 'none';
      }
    });

    // Date input mask for MM/DD/YYYY
    const dobInput = document.getElementById('dob');
    dobInput.addEventListener('input', (e) => {
      let value = e.target.value.replace(/\D/g, '').slice(0, 8);
      if (value.length >= 3 && value.length <= 4) {
        value = value.slice(0, 2) + '/' + value.slice(2);
      } else if (value.length >= 5) {
        value = value.slice(0, 2) + '/' + value.slice(2, 4) + '/' + value.slice(4);
      }
      e.target.value = value;
    });
  </script>
</body>
</html>
